def isJitpack = System.getenv("JITPACK") == "true"

// Always apply maven publish
apply plugin: "maven-publish"

// Apply signing only if NOT JitPack
if (!isJitpack) {
    apply plugin: "signing"
}

afterEvaluate { project ->

    publishing {
        publications {

            release(MavenPublication) {

                // Use project group & version (VERY IMPORTANT)
                groupId project.group
                artifactId project.name
                version project.version

                if (project.plugins.findPlugin("com.android.library")) {
                    from components.release
                } else {
                    from components.java
                }
            }
        }
    }
}

// Disable signing on JitPack
if (!isJitpack) {
    signing {
        useInMemoryPgpKeys(
                rootProject.ext["signingKeyId"],
                rootProject.ext["signingKey"],
                rootProject.ext["signingPassword"]
        )
        sign publishing.publications
    }
}
